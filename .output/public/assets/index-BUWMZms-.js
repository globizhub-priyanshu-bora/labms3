import{A as Q,D as G,r as l,j as e,B as t,X as D,E as H,F as X,G as J,H as K,I as V}from"./main-vMwdSAIQ.js";import{u as j}from"./index.esm-D6iZMFZI.js";import{L as W}from"./Layout-CaoylRxh.js";import{L as i}from"./label-CKz-pXdu.js";import{P as Y}from"./plus-DVRvYTQD.js";import{U as Z}from"./user-plus-9UywU3rS.js";import{S as _,T as $}from"./trash-2-CQB2gHtZ.js";import{S as ee}from"./search-DGwleQtH.js";import"./user-C1TGoub_.js";function me(){const E=Q.useLoaderData(),{showToast:a}=G(),[A,C]=l.useState(E?.data||[]),[q,d]=l.useState(!1),[z,c]=l.useState(!1),[h,n]=l.useState(null),[f,se]=l.useState(""),[k,x]=l.useState([]),[o,p]=l.useState(!1),{register:m,handleSubmit:F,reset:M,formState:{errors:y,isSubmitting:v}}=j(),{register:u,handleSubmit:R,reset:T,formState:{errors:w,isSubmitting:S}}=j(),{register:P,handleSubmit:I}=j(),g=async()=>{try{const s=await V({data:{limit:50,offset:0,sortBy:"name",sortOrder:"asc"}});s.success&&C(s.data)}catch(s){console.error("Error loading doctors:",s),a("Failed to load doctors","error")}},L=async s=>{try{(await J({data:{registrationNumber:s.registrationNumber,name:s.name,specialization:s.specialization||void 0,phoneNumber:s.phoneNumber?Number(s.phoneNumber):void 0}})).success?(d(!1),M(),await g(),a("Doctor added successfully","success")):a("Failed to add doctor","error")}catch(r){console.error("Error adding doctor:",r),a(r instanceof Error?r.message:"Failed to add doctor","error")}},b=async s=>{if(!s.query.trim()){x([]),p(!1);return}try{const r=await X({data:{query:s.query,limit:20,offset:0}});r.success&&(x(r.data),p(!0))}catch(r){console.error("Error searching doctors:",r),a("Search failed","error")}},O=s=>{n(s),T({registrationNumber:s.registrationNumber||"",name:s.name,specialization:s.specialization||"",phoneNumber:s.phoneNumber||void 0}),c(!0)},U=async s=>{if(h)try{(await K({data:{id:h.id,registrationNumber:s.registrationNumber,name:s.name,specialization:s.specialization||void 0,phoneNumber:s.phoneNumber?Number(s.phoneNumber):void 0}})).success?(c(!1),n(null),await g(),o&&await b({query:f}),a("Doctor updated successfully","success")):a("Failed to update doctor","error")}catch(r){console.error("Error updating doctor:",r),a(r instanceof Error?r.message:"Failed to update doctor","error")}},B=async s=>{if(confirm("Are you sure you want to delete this doctor?"))try{(await H({data:{id:s}})).success?(await g(),o&&await b({query:f}),a("Doctor deleted successfully","success")):a("Failed to delete doctor","error")}catch(r){console.error("Error deleting doctor:",r),a("Failed to delete doctor","error")}},N=o?k:A;return e.jsx(W,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"rounded-lg shadow-sm border",children:[e.jsxs("div",{className:"px-6 py-4 border-b",children:[e.jsxs("div",{className:"flex flex-row gap-5",children:[e.jsx("h2",{className:"text-lg font-semibold",children:o?"Search Results":"Available Doctors"}),e.jsxs(t,{onClick:()=>d(!0),className:"flex items-center gap-2 px-4 py-2 rounded-lg transition-colors font-medium",children:[e.jsx(Y,{className:"w-5 h-5"}),"Add New Doctor"]})]}),e.jsxs("p",{className:"text-sm mt-1",children:[N.length," doctor(s) found"]})]}),e.jsx("div",{className:"p-6",children:N.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Z,{className:"w-16 h-16 mx-auto mb-4"}),e.jsx("p",{className:"font-medium",children:"No doctors available"}),e.jsx("p",{className:"text-sm mt-2",children:'Click "Add New Doctor" to register a doctor'})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:N.map(s=>e.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 hover:shadow-md transition-all",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-slate-800 text-lg",children:s.name}),e.jsxs("p",{className:"text-sm text-slate-600 mt-1",children:["Reg: ",s.registrationNumber]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(t,{onClick:()=>O(s),className:"p-2 rounded-lg transition-colors",title:"Edit",children:e.jsx(_,{className:"w-4 h-4"})}),e.jsx(t,{onClick:()=>B(s.id),className:"p-2 rounded-lg transition-colors bg-red-500 hover:bg-red-600",title:"Delete",children:e.jsx($,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[s.specialization&&e.jsxs("p",{className:"text-sm text-slate-600",children:[e.jsx("span",{className:"font-medium",children:"Specialization:"})," ",s.specialization]}),s.phoneNumber&&e.jsxs("p",{className:"text-sm text-slate-600",children:[e.jsx("span",{className:"font-medium",children:"Phone:"})," ",s.phoneNumber]})]})]},s.id))})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"rounded-lg shadow-sm border p-6 mb-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Search Doctors"}),e.jsxs("form",{onSubmit:I(b),className:"space-y-3",children:[e.jsx("input",{...P("query"),placeholder:"Search by name...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsxs(t,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Search"]})]}),o&&e.jsx(t,{onClick:()=>{p(!1),x([])},className:"w-full mt-2 bg-gray-600 hover:bg-gray-700",children:"Clear Search"})]})})]})}),q&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Add New Doctor"}),e.jsx("button",{onClick:()=>d(!1),className:"text-gray-600 hover:text-gray-900",children:e.jsx(D,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:F(L),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Registration Number *"}),e.jsx("input",{...m("registrationNumber",{required:!0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"e.g., MCI12345"}),y.registrationNumber&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:"This field is required"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Name *"}),e.jsx("input",{...m("name",{required:!0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Doctor name"}),y.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:"This field is required"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Specialization"}),e.jsx("input",{...m("specialization"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"e.g., Cardiology"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Phone Number"}),e.jsx("input",{...m("phoneNumber"),type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"10-digit number"})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(t,{type:"button",onClick:()=>d(!1),className:"px-4 py-2 bg-gray-600 hover:bg-gray-700",children:"Cancel"}),e.jsx(t,{type:"submit",disabled:v,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:v?"Adding...":"Add Doctor"})]})]})]})}),z&&h&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Edit Doctor"}),e.jsx("button",{onClick:()=>{c(!1),n(null)},className:"text-gray-600 hover:text-gray-900",children:e.jsx(D,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:R(U),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Registration Number *"}),e.jsx("input",{...u("registrationNumber",{required:!0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"e.g., MCI12345"}),w.registrationNumber&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:"This field is required"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Name *"}),e.jsx("input",{...u("name",{required:!0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Doctor name"}),w.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:"This field is required"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Specialization"}),e.jsx("input",{...u("specialization"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"e.g., Cardiology"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Phone Number"}),e.jsx("input",{...u("phoneNumber"),type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"10-digit number"})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(t,{type:"button",onClick:()=>{c(!1),n(null)},className:"px-4 py-2 bg-gray-600 hover:bg-gray-700",children:"Cancel"}),e.jsx(t,{type:"submit",disabled:S,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:S?"Updating...":"Update Doctor"})]})]})]})})]})})}export{me as component};
