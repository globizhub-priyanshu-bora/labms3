import{a9 as N,c as u,w as y,r as i,j as e,g as v,aa as w,t as p,X as k}from"./main-7-PV94Mj.js";function L(a){return N({select:t=>t.location})}const C=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],M=u("chevron-down",C);const A=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],D=u("ellipsis-vertical",A);const S=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],_=u("log-out",S);const E=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],P=u("menu",E);function U(a,t){return a==="admin"||a==="Admin"||!t?!0:(Array.isArray(t)?t:[t]).some(d=>a.toLowerCase()===d.toLowerCase())}const j=i.createContext({user:null,loading:!0,logout:async()=>{}}),$=()=>i.useContext(j),F=({children:a,requiredRole:t})=>{const s=y(),[d,o]=i.useState(null),[x,n]=i.useState(!0),[l,h]=i.useState(null);i.useEffect(()=>{(async()=>{try{const c=await v();if(!c.success||!c.user){n(!1),s({to:"/"});return}const g=c.user;if(!g.hasCompletedSetup||!g.labId){n(!1),s({to:"/lab-setup"});return}if(t&&!U(g.role,t)){h(`Access denied. This page requires ${Array.isArray(t)?t.join(", "):t} role.`),n(!1);return}o(g),n(!1)}catch(c){console.error("Auth check error:",c),h("Failed to verify authentication"),n(!1),s({to:"/"})}})()},[s,t]);const b=async()=>{try{(await w({})).success?(p.success("Logged out successfully"),o(null),s({to:"/"})):p.error("Failed to logout")}catch(r){console.error("Logout error:",r),p.error(r instanceof Error?r.message:"Failed to logout"),o(null),s({to:"/"})}};return x?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):l?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsx("div",{className:"text-center max-w-md",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-red-800 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-red-700",children:l}),e.jsx("button",{onClick:()=>s({to:"/dashboard"}),className:"mt-4 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded",children:"Go to Dashboard"})]})})}):e.jsx(j.Provider,{value:{user:d,loading:x,logout:b},children:a})},f=[{to:"/dashboard",label:"Dashboard"},{to:"/patient-registration",label:"Patient Registration"},{to:"/bills",label:"Bills"},{to:"/tests",label:"Tests"},{to:"/test-parameters",label:"Parameters"},{to:"/doctors",label:"Doctors"},{to:"/lab-management",label:"Lab Management"}];function I(){const a=y(),t=L(),{user:s,logout:d}=$(),[o,x]=i.useState(!1),[n,l]=i.useState(!1),h=async()=>{await d()},b=t.pathname==="/lab-management";return e.jsxs(e.Fragment,{children:[e.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-40",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs(m,{to:s?.isAdmin?"/lab-management":"/dashboard",className:"flex items-center gap-3 group",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-lg flex items-center justify-center shadow-lg group-hover:shadow-xl transition-shadow",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"L"})}),e.jsxs("div",{className:"hidden sm:block",children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Lab Management"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Professional Healthcare Lab"})]})]}),e.jsx("div",{className:"hidden lg:flex items-center gap-1",children:f.map((r,c)=>e.jsx(m,{to:r.to,className:`px-3 py-2 text-sm font-medium rounded-md transition-colors ${t.pathname===r.to?"bg-blue-100 text-blue-700":"text-gray-700 hover:text-gray-900 hover:bg-gray-50"}`,children:r.label},c))}),e.jsxs("div",{className:"hidden lg:flex items-center gap-3",children:[e.jsxs("div",{className:"text-right pr-3 border-r border-gray-200",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s?.name}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:s?.role})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>x(!o),className:"px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md inline-flex items-center gap-1 transition-colors",children:[e.jsx(D,{className:"w-4 h-4"}),"More",e.jsx(M,{className:`w-4 h-4 transition-transform ${o?"rotate-180":""}`})]}),o&&e.jsxs("div",{className:"absolute right-0 mt-1 w-56 bg-white border border-gray-200 rounded-md shadow-lg py-2 z-50",children:[s?.isAdmin&&e.jsx("button",{onClick:()=>{x(!1),a({to:"/admin/user-management"})},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:"��� User Management"}),e.jsx(m,{to:"/dashboard",onClick:()=>x(!1),className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:"��� Dashboard"}),s?.isAdmin&&e.jsx("button",{onClick:()=>{x(!1),a({to:"/lab-details"})},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:"��� Lab Details"}),e.jsxs("button",{onClick:h,className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center gap-2 border-t border-gray-200 mt-2 pt-2",children:[e.jsx(_,{className:"w-4 h-4"}),"Logout"]})]})]})]}),e.jsx("button",{onClick:()=>l(!n),className:"lg:hidden p-2 text-gray-700 hover:bg-gray-50 rounded-md",children:n?e.jsx(k,{className:"w-6 h-6"}):e.jsx(P,{className:"w-6 h-6"})})]})})}),b&&e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-blue-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Lab Information"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Name: Your Laboratory | Registration: LAB-12345"})]})})})}),n&&e.jsx("div",{className:"lg:hidden bg-white border-b border-gray-200",children:e.jsxs("div",{className:"px-4 py-2 space-y-1",children:[f.map((r,c)=>e.jsx(m,{to:r.to,onClick:()=>l(!1),className:"block px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:r.label},c)),e.jsxs("div",{className:"border-t border-gray-200 pt-2 mt-2",children:[s?.isAdmin&&e.jsx(m,{to:"/admin/user-management",onClick:()=>l(!1),className:"block px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:"User Management"}),e.jsx(m,{to:"/dashboard",onClick:()=>l(!1),className:"block px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:"Dashboard"}),s?.isAdmin&&e.jsx("button",{onClick:()=>{l(!1),a({to:"/lab-details"})},className:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:"Lab Details"}),e.jsx("button",{onClick:()=>{l(!1),h()},className:"w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md border-t border-gray-200 mt-2 pt-2",children:"Logout"})]})]})})]})}function m({to:a,className:t="",onClick:s,children:d}){const o=y();return e.jsx("button",{onClick:()=>{s?.(),o({to:a})},className:t,children:d})}const H=({children:a,requiredRole:t})=>e.jsx(F,{requiredRole:t,children:e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(I,{}),e.jsx("main",{children:a})]})});export{H as L,$ as u};
