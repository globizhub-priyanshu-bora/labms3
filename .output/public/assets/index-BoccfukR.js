import{G as V,r as i,u as M,j as e,B as l,X as R,L as r,H as W,t as a,I as Y,J as Z,K as _,N as $}from"./main-7-PV94Mj.js";import{L as ee}from"./Layout-BjyUM3rL.js";import{U as k}from"./user-plus-BB8BuFDr.js";import{S as se,T as te}from"./trash-2-B2o36O0X.js";import{S as re}from"./search-D_ZCAR2S.js";function ce(){const O=V.useLoaderData(),[I,n]=i.useState(!1),[L,m]=i.useState(!1),[g,D]=i.useState(null),[x,S]=i.useState(""),[G,p]=i.useState([]),[u,y]=i.useState(!1),[h,b]=i.useState(null),[o,f]=i.useState(null),{register:d,handleSubmit:T,reset:U,formState:{errors:E,isSubmitting:P}}=M(),{register:c,handleSubmit:B,reset:Q,formState:{errors:q,isSubmitting:C}}=M(),j=u?G:O?.data||[],N=async()=>{try{(await $({data:{limit:100,offset:0,sortBy:"name",sortOrder:"asc"}})).success&&window.location.reload()}catch{a.error("Failed to load doctors")}},H=async s=>{try{(await Z({data:{registrationNumber:s.registrationNumber,name:s.name,gender:s.gender||void 0,specialization:s.specialization||void 0,phoneNumber:s.phoneNumber?Number(s.phoneNumber):void 0,photoDocument:h||void 0}})).success?(n(!1),U(),b(null),await N(),a.success("Doctor added successfully")):a.error("Failed to add doctor")}catch(t){console.error("Error adding doctor:",t),a.error(t instanceof Error?t.message:"Failed to add doctor")}},v=async s=>{if(!s.query.trim()){p([]),y(!1);return}try{const t=await Y({data:{query:s.query,limit:20,offset:0}});t.success&&(p(t.data),y(!0))}catch(t){console.error("Error searching doctors:",t),a.error("Search failed")}},J=s=>{D(s),f(s.photoDocument||null),Q({registrationNumber:s.registrationNumber||"",name:s.name,gender:s.gender||"",specialization:s.specialization||"",phoneNumber:s.phoneNumber||void 0}),m(!0)},K=async s=>{if(g)try{(await _({data:{id:g.id,registrationNumber:s.registrationNumber,name:s.name,gender:s.gender||void 0,specialization:s.specialization||void 0,phoneNumber:s.phoneNumber?Number(s.phoneNumber):void 0,photoDocument:o||void 0}})).success?(m(!1),D(null),f(null),await N(),u&&await v({query:x}),a.success("Doctor updated successfully")):a.error("Failed to update doctor")}catch(t){console.error("Error updating doctor:",t),a.error(t instanceof Error?t.message:"Failed to update doctor")}},X=async s=>{if(confirm("Are you sure you want to delete this doctor?"))try{(await W({data:{id:s}})).success?(await N(),u&&await v({query:x}),a.success("Doctor deleted successfully")):a.error("Failed to delete doctor")}catch(t){console.error("Error deleting doctor:",t),a.error("Failed to delete doctor")}},A=(s,t=!1)=>{const z=s.target.files?.[0];if(z){const w=new FileReader;w.onloadend=()=>{const F=w.result;t?f(F):b(F)},w.readAsDataURL(z)}};return e.jsx(ee,{children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Doctors Management"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage medical professionals and their information"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Doctors List"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[j.length," doctor(s) found"]})]}),e.jsxs(l,{onClick:()=>{n(!0),b(null)},className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Add New Doctor"]})]}),e.jsx("div",{className:"p-6",children:j.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(k,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"font-medium text-gray-900",children:"No doctors available"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:'Click "Add New Doctor" to register a doctor'})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Registration"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Gender"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Specialization"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Phone"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Actions"})]})}),e.jsx("tbody",{children:j.map(s=>e.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:s.name}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:s.registrationNumber||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:s.gender||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:s.specialization||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:s.phoneNumber||"-"}),e.jsxs("td",{className:"px-4 py-3 text-sm flex gap-2",children:[e.jsx(l,{onClick:()=>J(s),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Edit",children:e.jsx(se,{className:"w-4 h-4"})}),e.jsx(l,{onClick:()=>X(s.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",children:e.jsx(te,{className:"w-4 h-4"})})]})]},s.id))})]})})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Search Doctors"}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),v({query:x})},className:"space-y-3",children:[e.jsx("div",{children:e.jsx("input",{type:"text",value:x,onChange:s=>S(s.target.value),placeholder:"Search by name or specialization",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})}),e.jsxs(l,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700",children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"Search"]}),u&&e.jsx(l,{type:"button",onClick:()=>{p([]),y(!1),S("")},className:"w-full bg-gray-600 hover:bg-gray-700",children:"Clear Search"})]})]})})]}),I&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Add New Doctor"}),e.jsx("button",{onClick:()=>n(!1),className:"text-gray-600 hover:text-gray-900",children:e.jsx(R,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:T(H),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(r,{className:"text-sm font-medium text-gray-900",children:"Registration Number *"}),e.jsx("input",{...d("registrationNumber",{required:"Required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm mt-1",placeholder:"e.g., MCI12345"}),E.registrationNumber&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:"This field is required"})]}),e.jsxs("div",{children:[e.jsx(r,{className:"text-sm font-medium text-gray-900",children:"Name *"}),e.jsx("input",{...d("name",{required:"Required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm mt-1",placeholder:"Doctor name"}),E.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:"This field is required"})]}),e.jsxs("div",{children:[e.jsx(r,{className:"text-sm font-medium text-gray-900",children:"Gender"}),e.jsxs("select",{...d("gender"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm mt-1",children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx(r,{className:"text-sm font-medium text-gray-900",children:"Specialization"}),e.jsx("input",{...d("specialization"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm mt-1",placeholder:"e.g., Cardiology"})]}),e.jsxs("div",{children:[e.jsx(r,{className:"text-sm font-medium text-gray-900",children:"Phone Number"}),e.jsx("input",{...d("phoneNumber"),type:"tel",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm mt-1",placeholder:"10-digit number"})]}),e.jsxs("div",{children:[e.jsx(r,{className:"text-sm font-medium text-gray-900",children:"Photo / ID Document"}),e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:s=>A(s,!1),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm mt-1"}),h&&e.jsx("div",{className:"mt-2 relative w-full h-32 bg-gray-100 rounded-lg overflow-hidden",children:h.includes("pdf")?e.jsx("div",{className:"flex items-center justify-center h-full text-gray-600",children:"PDF Document"}):e.jsx("img",{src:h,alt:"Preview",className:"w-full h-full object-cover"})})]}),e.jsxs("div",{className:"flex gap-2 justify-end pt-4 border-t",children:[e.jsx(l,{type:"button",onClick:()=>n(!1),className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg",children:"Cancel"}),e.jsx(l,{type:"submit",disabled:P,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg disabled:opacity-50",children:P?"Adding...":"Add Doctor"})]})]})]})}),L&&g&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Edit Doctor"}),e.jsx("button",{onClick:()=>m(!1),className:"text-gray-600 hover:text-gray-900",children:e.jsx(R,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:B(K),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(r,{className:"text-sm font-medium text-gray-900",children:"Registration Number *"}),e.jsx("input",{...c("registrationNumber",{required:"Required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm mt-1",placeholder:"e.g., MCI12345"}),q.registrationNumber&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:"This field is required"})]}),e.jsxs("div",{children:[e.jsx(r,{className:"text-sm font-medium text-gray-900",children:"Name *"}),e.jsx("input",{...c("name",{required:"Required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm mt-1",placeholder:"Doctor name"}),q.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:"This field is required"})]}),e.jsxs("div",{children:[e.jsx(r,{className:"text-sm font-medium text-gray-900",children:"Gender"}),e.jsxs("select",{...c("gender"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm mt-1",children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx(r,{className:"text-sm font-medium text-gray-900",children:"Specialization"}),e.jsx("input",{...c("specialization"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm mt-1",placeholder:"e.g., Cardiology"})]}),e.jsxs("div",{children:[e.jsx(r,{className:"text-sm font-medium text-gray-900",children:"Phone Number"}),e.jsx("input",{...c("phoneNumber"),type:"tel",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm mt-1",placeholder:"10-digit number"})]}),e.jsxs("div",{children:[e.jsx(r,{className:"text-sm font-medium text-gray-900",children:"Photo / ID Document"}),e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:s=>A(s,!0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm mt-1"}),o&&e.jsx("div",{className:"mt-2 relative w-full h-32 bg-gray-100 rounded-lg overflow-hidden",children:o.includes("pdf")||o.includes("application")?e.jsx("div",{className:"flex items-center justify-center h-full text-gray-600",children:"PDF Document"}):e.jsx("img",{src:o,alt:"Preview",className:"w-full h-full object-cover"})})]}),e.jsxs("div",{className:"flex gap-2 justify-end pt-4 border-t",children:[e.jsx(l,{type:"button",onClick:()=>m(!1),className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg",children:"Cancel"}),e.jsx(l,{type:"submit",disabled:C,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg disabled:opacity-50",children:C?"Updating...":"Update Doctor"})]})]})]})})]})})}export{ce as component};
