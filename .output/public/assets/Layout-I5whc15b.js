import{c as i,w as v,r as o,j as e,g as k,Z as c,a7 as M,a8 as A}from"./main-B5l_WD0C.js";const C=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],N=i("chevron-down",C);const L=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],_=i("ellipsis-vertical",L);const D=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],S=i("flask-conical",D);const $=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],U=i("log-out",$);const P=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],H=i("menu",P);const I=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],b=i("panels-top-left",I);const z=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],E=i("settings",z);const V=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],y=i("users",V);function B(n,s){return n==="admin"||n==="Admin"||!s?!0:(Array.isArray(s)?s:[s]).some(d=>n.toLowerCase()===d.toLowerCase())}const w=o.createContext({user:null,loading:!0}),F=()=>o.useContext(w),T=({children:n,requiredRole:s})=>{const l=v(),[d,p]=o.useState(null),[m,r]=o.useState(!0),[x,h]=o.useState(null);return o.useEffect(()=>{(async()=>{try{const t=await k();if(!t.success||!t.user){r(!1),l({to:"/"});return}const g=t.user;if(!g.hasCompletedSetup||!g.labId){r(!1),l({to:"/lab-setup"});return}if(s&&!B(g.role,s)){h(`Access denied. This page requires ${Array.isArray(s)?s.join(", "):s} role.`),r(!1);return}p(g),r(!1)}catch(t){console.error("Auth check error:",t),h("Failed to verify authentication"),r(!1),l({to:"/"})}})()},[l,s]),m?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):x?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsx("div",{className:"text-center max-w-md",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-red-800 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-red-700",children:x}),e.jsx("button",{onClick:()=>l({to:"/dashboard"}),className:"mt-4 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded",children:"Go to Dashboard"})]})})}):e.jsx(w.Provider,{value:{user:d,loading:m},children:n})};function G(){const n=v(),{user:s,logout:l}=F(),[d,p]=o.useState(!1),[m,r]=o.useState(!1),[x,h]=o.useState(!1),f=async()=>{l(),n({to:"/login"})},t=(a,u)=>s.isAdmin?!0:s.permissions?s.permissions?.[a]?.[u]??!1:!1,j=(()=>{const a=[];return(t("patients","view")||t("patient","read"))&&a.push({to:"/patients/register",label:"Patient Registration",icon:y}),(t("tests","view")||t("test","read"))&&a.push({to:"/tests/",label:"Tests",icon:b}),(t("doctors","view")||t("doctor","read"))&&a.push({to:"/doctors/",label:"Doctors",icon:y}),(t("parameters","view")||t("parameters","read")||t("test_parameter","read"))&&a.push({to:"/test-parameters/",label:"Parameters",icon:E}),(t("bills","view")||t("bills","create")||t("bill","read"))&&a.push({to:"/bills/$id",label:"Bills",icon:b}),a.push({to:"/lab-management",label:"Lab Management",icon:b}),a})();return e.jsxs(e.Fragment,{children:[e.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-40",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs(c,{to:s.isAdmin?"/lab-management":"/dashboard",className:"flex items-center gap-3 group",children:[e.jsx("div",{className:"bg-black text-white p-2 rounded-lg transition-colors group-hover:bg-gray-800",children:e.jsx(S,{className:"w-6 h-6"})}),e.jsxs("div",{className:"hidden sm:block",children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Lab Management"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Professional Healthcare Lab"})]})]}),e.jsxs("div",{className:"hidden lg:flex items-center gap-1",children:[j.map((a,u)=>e.jsxs(c,{to:a.to,className:"px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md inline-flex items-center gap-2 transition-colors",children:[e.jsx(a.icon,{className:"w-4 h-4"}),a.label]},u)),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>h(!x),className:"px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md inline-flex items-center gap-1 transition-colors ml-2",children:[e.jsx(_,{className:"w-4 h-4"}),"More",e.jsx(N,{className:`w-4 h-4 transition-transform ${x?"rotate-180":""}`})]}),x&&e.jsxs("div",{className:"absolute right-0 mt-1 w-56 bg-white border border-gray-200 rounded-md shadow-lg py-2 z-50",children:[(s.isAdmin||t("users","view"))&&e.jsxs(c,{to:"/admin/dashboard",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[e.jsx(y,{className:"w-4 h-4"}),"User Management"]}),e.jsxs(c,{to:"/dashboard",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4"}),"Dashboard"]}),e.jsxs("button",{onClick:()=>{h(!1),n({to:"/lab-management"})},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Lab Details"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>p(!d),className:"px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md inline-flex items-center gap-2 transition-colors",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-bold",children:s.name.charAt(0).toUpperCase()}),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.role})]}),e.jsx(N,{className:`w-4 h-4 transition-transform ${d?"rotate-180":""}`})]}),d&&e.jsxs("div",{className:"absolute right-0 mt-1 w-48 bg-white border border-gray-200 rounded-md shadow-lg py-2 z-50",children:[e.jsxs("div",{className:"px-4 py-2 border-b border-gray-200",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.email})]}),e.jsxs("button",{onClick:f,className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),"Logout"]})]})]}),e.jsx("button",{onClick:()=>r(!m),className:"lg:hidden p-2 text-gray-700 hover:bg-gray-50 rounded-md transition-colors",children:e.jsx(H,{className:"w-5 h-5"})})]})]})})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-blue-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Lab Information"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Name: Your Laboratory | Registration: LAB-12345"})]})})})}),m&&e.jsx("div",{className:"lg:hidden bg-white border-b border-gray-200",children:e.jsxs("div",{className:"px-4 py-2 space-y-1",children:[j.map((a,u)=>e.jsx(c,{to:a.to,onClick:()=>r(!1),className:"block px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:a.label},u)),e.jsxs("div",{className:"border-t border-gray-200 pt-2 mt-2",children:[(s.isAdmin||t("users","view"))&&e.jsx(c,{to:"/admin/dashboard",onClick:()=>r(!1),className:"block px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:"User Management"}),e.jsx(c,{to:"/dashboard",onClick:()=>r(!1),className:"block px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:"Dashboard"}),e.jsx(c,{to:"/lab-management",onClick:()=>r(!1),className:"block px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:"Lab Details"})]})]})})]})}const Z=({children:n,requiredRole:s})=>e.jsx(T,{requiredRole:s,children:e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(G,{}),e.jsx("main",{children:n})]})});export{Z as L,y as U,F as u};
